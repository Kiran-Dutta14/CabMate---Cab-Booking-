<div class="container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <div class="logo-icon">CM</div>
      <div class="logo-text">CabMate</div>
    </div>

    <nav class="nav-menu">
      <a routerLink="/driver-dashboard" routerLinkActive="active" class="nav-item active">
        <img src="assets/images/dashboard2.png" > Dashboard
      </a>
      <a href="#" class="nav-item"><img src="assets/images/history.png" > Ride History</a>
      <a href="#" class="nav-item"><img src="assets/images/chat.png" > Messages</a>
      <a href="#" class="nav-item"><img src="assets/images/earnings.png" > Earnings</a>
      <a href="#" class="nav-item"><img src="assets/images/settings.png" > Settings</a>
    </nav>

    <div class="driver-card" *ngIf="driver">
      <div class="driver-info">
        <div class="driver-avatar">{{ driver.initials || 'D' }}</div>
        <div class="driver-details">
          <h3>{{ driver.name || 'Driver' }}</h3>
          <p>{{ driver.car || 'Unknown Car' }} • {{ driver.plate || 'N/A' }}</p>
          <div class="rating">
            <img src="assets/images/star.png" >
            <span>{{ driver.rating || 0 }}</span>
          </div>
        </div>
      </div>
      <div class="online-status" (click)="toggleOnline()">
        {{ online ? 'Go Offline' : 'Go Online' }}
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="header">
      <h1>Driver Dashboard</h1>
      <div>{{ today | date: 'fullDate' }}</div>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-title"><img src="assets/images/earning2.png" >Today's Earnings</div>
        <div class="stat-value">${{ stats.earnings }}</div>
      </div>
      <div class="stat-card">
        <div class="stat-title"><img src="assets/images/car-insurance.png" >Completed Rides</div>
        <div class="stat-value">{{ stats.completedRides }}</div>
      </div>
      <div class="stat-card">
        <div class="stat-title"><img src="assets/images/rating.png" >Rating</div>
        <div class="stat-value">{{ driver.rating || 0 }}</div>
      </div>
    </div>

    <!-- Map + Ride Requests -->
    <div class="dashboard-content">
      <div class="map-container">
        <div id="map"></div>

        <div class="ride-request" [class.active]="rideRequestVisible">
          <div class="ride-details">
            <div class="ride-locations">
              <div class="location">
                <div class="location-dot pickup-dot"></div>
                <div class="location-text">{{ driver.lastPickup || 'Pickup Location' }}</div>
              </div>
              <div class="location">
                <div class="location-dot dropoff-dot"></div>
                <div class="location-text">{{ driver.lastDropoff || 'Dropoff Location' }}</div>
              </div>
            </div>
            <div class="ride-info">
              <div>Distance: <span>-- km</span></div>
              <div>Fare: <span>₹ --</span></div>
            </div>
          </div>
          <div class="ride-actions">
            <button class="btn btn-outline" (click)="declineRide()">Decline</button>
            <button class="btn btn-primary" (click)="acceptRide()">Accept</button>
          </div>
        </div>
      </div>

      <!-- Recent Rides -->
      <div class="panel">
        <div class="panel-header">Recent Rides</div>
        <div class="panel-content">
          <ul class="ride-history" *ngIf="recentRides && recentRides.length > 0; else noRides">
            <li class="ride-item" *ngFor="let ride of recentRides">
             {{ ride.date }} - {{ ride.route }} - ₹{{ ride.earnings }}
             
            

            </li>
          </ul>
           <ng-template #noRides>
            <p class="empty-message">No rides found yet.</p>
          </ng-template>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Fallback when no driver is logged in -->
<ng-template #noDriver>
  <div class="empty-dashboard">
    <h2>No driver logged in</h2>
    <p>Please <a routerLink="/signin">sign in</a> to view your dashboard.</p>
  </div>
</ng-template>